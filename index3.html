<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<link rel="icon" type="image/png" href="./favicon.ico">
	<title>VNP ERP - Demo by Hn</title>
	<meta name="keywords" content="" />
	<meta name="description" content="" />
	
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css">
	<link rel="stylesheet" href="./css/style.css">
	<!--Sidebar menu -->
	<link rel="stylesheet" href="./css/sidebar-menu.css">
	<!--Noty -->
	<link rel="stylesheet" href="./css/noty.css">
	<!--DataTables.net -->
	<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.13/css/jquery.dataTables.css">
	<!--Toggle Switch: checkbox On/Off-->
	<link rel="stylesheet" type="text/css" href="./css/tinytools.toggleswitch.min.css">
	<style>
	/* Khung đăng nhập ở góc trên bên phải*/
	#logindiv {
		display: none;
		position:fixed;
		right: 14px;
		top: 30px;
		background-color:#ffc299;
		border-radius: 7px;
		width: 190px;
		height: 160px;
		padding: 10px;
		border-style:solid;
		border-side: 1px;
		border-color: #ff944d;
		box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);
	}
	</style>
</head>

<body>

<div class="wrapper">
<!--
	<header class="header">
		<img id="logo" src="./image/logo.png" style="width:220px;padding-top:20px"/>
	</header> .header-->

	<div class="middle">

		<div class="container">
			<!-- Content-->
			<main class="content">
			
				<!-- Upload hình ảnh-->
				<div id="upload"> 
					<img id="preview" src="./image/person-placeholder.jpg"/>
					<input type="file" name="avatarfile" id="avatarfile" onchange="previewImage(this)" accept="image/*"/>
				</div>
				
				<!-- Popup Đăng nhập -->
				<button type="button" class="btn btn-default btn-sm" id="hide" style="position:fixed; right:15px; top:0px;">
				  <span class="glyphicon glyphicon-user"> Login
				</button>	
				<div id="logindiv" >
					<form action="login.php" method="post" id="login-form">
					  Username:<br>
					  <input type="text" name="username" id="username" value="admin" >
					  <br>
					  Password:<br>
					  <input type="password" name="password" id="password" value="1a2b3c" >
					  <br>
					  <span style="color:gray;">Valid account: admin | 12345</span>
					  <br>
					  <button type="submit" class="btn btn-default btn-sm" style="margin-left:50px;margin-top:5px;">
						  <span class="glyphicon glyphicon-chevron-right"></span> Login
						</button>
					</form> 
				</div>
				
				<hr>
				<h4 id="message" style="color: green"></h4>
				
				<!-- Bảng sản phẩm-->
				<div id="tableholder">
				<table id="producttbl" class="display" cellspacing="0" width="100%" style="background-color:white;">
					<thead>
					<tr>
						<th>Image</th>
						<th>Link</th>
						<th>ID</th>
						<th>Name</th>
						<th>Status</th>
					</tr>
					</thead>
					<tbody>
					<tr>
						<td>1</td>
						<td>image/a.png</td>
						<td>lt001</td>
						<td>Dell Studio</td>
						<td>0</td>
					</tr>
					<tr>
						<td>2</td>
						<td>image/b.png</td>
						<td>ca002</td>
						<td>Volkswagen Beetle</td>
						<td>1</td>
					</tr>
					<tr>
						<td>3</td>
						<td>image/c.jpg</td>
						<td>ca001</td>
						<td>BMW</td>
						<td>1</td>
					</tr>
					<tr>
						<td>4</td>
						<td>image/d.jpg</td>
						<td>bk001</td>
						<td>Honda Airblade</td>
						<td>0</td>
					</tr>
					</tbody>
				</table>
				</div>
			</main><!-- .content -->
		</div><!-- .container-->

		<!-- Menu dọc bên trái-->
		<aside class="left-sidebar" id="left-sidebar">
			<ul class="sidebar-menu">
			  <li class="sidebar-header"><img id="logo" src="./image/logo.png" style="width:200px;margin-left:-15px"/></li>
			  <li>
				<a href="#">
				  <i class="fa fa-dashboard"></i> <span>Dashboard</span> <i class="fa fa-angle-left pull-right"></i>
				</a>
				<ul class="sidebar-submenu">
				  <li><a href="#"><i class="fa fa-circle-o"></i> Dashboard v1</a></li>
				  <li><a href="#"><i class="fa fa-circle-o"></i> Dashboard v2</a></li>
				</ul>
			  </li>
			  <li>
				<a href="#">
				  <i class="fa fa-files-o"></i>
				  <span>Documentation</span>
				  <span class="label label-primary pull-right">4</span>
				</a>
				<ul class="sidebar-submenu" style="display: none;">
				  <li><a href="#"><i class="fa fa-circle-o"></i>My document</a></li>
				  <li><a href="#"><i class="fa fa-circle-o"></i> New document</a></li>
				  <li><a href="#"><i class="fa fa-circle-o"></i> Regulation</a></li>
				  <li class=""><a href="collapsed-sidebar.html"><i class="fa fa-circle-o"></i> Trash</a>
				  </li>
				</ul>
			  </li>
			  <li>
				<a href="#">
				  <i class="fa fa-th"></i> <span>Notification</span>
				  <small class="label pull-right label-info">new</small>
				</a>
			  </li>
			  <li>
				<a href="#">
				  <i class="fa fa-pie-chart"></i>
				  <span>General Report</span>
				  <i class="fa fa-angle-left pull-right"></i>
				</a>
				<ul class="sidebar-submenu">
				  <li><a href="#"><i class="fa fa-circle-o"></i> Sales</a></li>
				  <li><a href="#"><i class="fa fa-circle-o"></i> Inventory</a></li>
				  <li><a href="#"><i class="fa fa-circle-o"></i> Human Resource</a></li>
				  <li><a href="#"><i class="fa fa-circle-o"></i> Financial</a></li>
				</ul>
			  </li>
			  <li>
				<a href="#">
				  <i class="fa fa-laptop"></i>
				  <span>Sales</span>
				  <i class="fa fa-angle-left pull-right"></i>
				</a>
				<ul class="sidebar-submenu">
				  <li><a href="#"><i class="fa fa-circle-o"></i> Dashboard</a></li>
				  <li><a href="#"><i class="fa fa-circle-o"></i> Sales Orders</a></li>
				  <li><a href="#"><i class="fa fa-circle-o"></i> Products</a></li>
				  <li><a href="#"><i class="fa fa-circle-o"></i> Sales Staffs</a></li>
				  <li><a href="#"><i class="fa fa-circle-o"></i> Customers</a></li>
				  <li><a href="#"><i class="fa fa-circle-o"></i> Reports</a></li>
				</ul>
			  </li>
			  <li>
				<a href="#">
				  <i class="fa fa-edit"></i> <span>Project</span>
				  <i class="fa fa-angle-left pull-right"></i>
				</a>
				<ul class="sidebar-submenu">
				  <li><a href="#"><i class="fa fa-circle-o"></i> Dashboard</a></li>
				  <li><a href="#"><i class="fa fa-circle-o"></i> Projects</a></li>
				  <li><a href="#"><i class="fa fa-circle-o"></i> Reports</a></li>
				</ul>
			  </li>
			  <li>
				<a href="#">
				  <i class="fa fa-table"></i> <span>Inventory</span>
				  <i class="fa fa-angle-left pull-right"></i>
				</a>
				<ul class="sidebar-submenu">
				  <li><a href="#"><i class="fa fa-circle-o"></i> Dashboard</a></li>
				  <li><a href="#"><i class="fa fa-circle-o"></i> Good Receipt </a></li>
				  <li><a href="#"><i class="fa fa-circle-o"></i> Internal Transfers </a></li>
				  <li><a href="#"><i class="fa fa-circle-o"></i> Delivery Orders </a></li>
				  <li><a href="#"><i class="fa fa-circle-o"></i> Reports </a></li>
				</ul>
			  </li>
			  <li>
				<a href="#">
				  <i class="fa fa-calendar"></i> <span>Sales Forecast</span>
				  <small class="label pull-right label-danger">3</small>
				</a>
			  </li>
			  <li>
				<a href="#">
				  <i class="fa fa-envelope"></i> <span>Mailbox</span>
				  <small class="label pull-right label-warning">12</small>
				</a>
			  </li>
			  <li><a href="#"><i class="fa fa-book"></i> <span>Settings</span></a></li>
			  <li class="sidebar-header">LABELS</li>
			  <li><a href="#"><i class="fa fa-circle-o text-red"></i> <span>Important</span></a></li>
			  <li><a href="#"><i class="fa fa-circle-o text-yellow"></i> <span>Warning</span></a></li>
			  <li><a href="#"><i class="fa fa-circle-o text-aqua"></i> <span>Information</span></a></li>
			</ul>
		</aside><!-- .left-sidebar -->

	</div><!-- .middle-->

</div><!-- .wrapper -->

<footer class="footer">
	<div class="element">
	© 2017 Cyberstorm Team
	</div>
</footer> <!--.footer -->

<!------------------------------------------------------------------------------------->
<!-- Latest compiled JavaScript -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script src="https://cdn.datatables.net/1.10.13/js/jquery.dataTables.min.js"></script>
<!-- Sidebar Menu: http://www.jqueryscript.net/menu/Responsive-Admin-Sidebar-Menu-Plugin-With-jQuery-sidebar-nav.html -->
<script src="./js/sidebar-menu.js"></script>
<!-- ToggleSwitch: http://tinytools.codesells.com/ToggleSwitch -->
<script src="./js/tinytools.toggleswitch.min.js"></script>
<!-- Noty: http://ned.im/noty/ -->
<script src="./js/noty.js"></script>
<!------------------------------------------------------------------------------------->

<script>
    $.sidebarMenu($('.sidebar-menu'));
	$(document).ready( function () {
		//1. Datatables
		$('#producttbl').DataTable({ 
				"columnDefs": [ {
						//Xử lý để hiển thị hình sản phẩm 
						//đồng thời demo là 1 link để gọi đến phía server side kèm theo ID
						//đây chỉ là ví dụ, nên nghiên cứu gọi Ajax bằng JQuery để khỏi load lại trang.
					"targets": 0, //Cột sẽ hiển thị kết quả của function bên dưới, hình sẽ hiển thị ở cột đầu tiên
					//"data": null, //null là lấy tất cả cột dữ liệu có trong bảng
					"render": function ( data, type, row, meta ) {
						return '<a href="change.php?id='+row[2]+'"><img height="40" width="50" src="'+row[1]+'"></a>';
						}
					} , 
					{ 	//Hiển thị toggle switch, nếu value là 1 thì ON, 0 thì OFF,
						//Nên làm thành link nhấn được để chuyển trạng thái
						"targets": 4, //Cột sẽ hiển thị kết quả của function bên dưới
									//Không khai báo data, dùng row để lấy giá trị
						"render": function ( data, type, row, meta ) {
							return row[4]== '1' ? '<input type="checkbox" class="tws" checked pid="'+row[2]+'"/>': '<input type="checkbox" class="tws" pid="'+row[2]+'"/>';
						}
					},
					{ 	//Ẩn cột đường dẫn tới hình
						"targets": 1,
						"visible": false
					}
				]
		});
		
		//2. Toggle Switch
		$(".tws").toggleSwitch({
			width:"60px",
			height:"25px",
			onLabel:"|",
			offLabel:"O"
		});
		
		//3. Upload Preview
		$('#preview').click(function(){
				$('#avatarfile').click();
		});
		//4. Khi nhấn nút sẽ ẩn hiện phần đầu trang
		 $("#hide").click(function(){
			$("#logindiv").toggle('fast');
		});
		
		//5. Khi thay đổi trạng thái On/Off trong Status
		$(".tws").change(function(){
			//Lấy mã sản phẩm lưu trong checkbox ở thuộc tính pid tự tạo
			var productid = $(this).attr('pid');			
			
			//GỌI AJAX GET: gửi productid về trang product.php ở server để xử lý
			/*
			$.get("product.php?pid="+productid, function(data, status){
				//Khi server xử lý xong, trả kết quả về là data, status là trạng thái cho biết thành công hay không
				alert(data);
				var message = "Ajax call result:</br> Name: "+json.name+"</br>Price: "+json.price;
				//HIỂN THỊ THÔNG BÁO TỰ TẮT DÙNG THƯ VIỆN NOTY,
				//vào website ned.im/noty/ xem các options
				new Noty({
					text: message,
					theme: 'metroui',
					timeout: 1500,
					layout: 'bottomRight',
					type: 'information',
					killer: true,
				}).show();
			});
			*/
			//CÁCH KHÁC, GỌI AJAX ĐẦY ĐỦ có thông báo lỗi
			$.ajax({
				type: 'GET',
				url: 'product.php',
				data: "pid=" + productid, //Nhiều thông tin hơn: "pid=abc & pname=xyz & pdescription=ght"
				//Trường hợp thành công
				success: function(data, status) {
					//data nhận được từ server là JSON đã ở dạng object, truy cập các thuộc tính qua dấu chấm: data.name
					var message = "Result from server:</br> Product Name: "+data.name+"</br>Price: "+data.price.toLocaleString()+"$";
					console.log(data);	//Ghi log ra màn hình console, nhấn F12 ở trình duyệt Chrome, tab Console để xem
					new Noty({
						text: message,
						theme: 'metroui',
						timeout: 1500,
						layout: 'bottomRight',
						type: 'information',
					}).show();
				},
				//Trường hợp bị lỗi
				error: function(xhr, status, error) {
					console("Error: "+ xhr.responseText);
					//Nhấn F12 trong Chrome, chọn tab Console để xem lỗi
				}
			});
			
		}); // .end phần 5 Change on/off
		
		//6. Nhấn submit form login
		$("#login-form").on( "submit", function( event ) {
			event.preventDefault(); //Không thực hiện submit như mặc định (sẽ khiến load trang)
			
			//Gửi thông tin trong form đến login.php
			//$(this).serialize() nhằm gửi tất cả thông tin có trong form cùng lúc theo định dạng chuẩn
			$.post("login.php", $( this ).serialize() , function(data) {
					//Xử lý kết quả server trả lại client sau khi xử lý
					var message;
					var notytype;

					if (data == true){	//Nếu server trả về true
						message = "Hi "+$("#username").val()+", you have successfully logged in.";
						notytype = 'success';
						$("#logindiv").toggle('slow');	//Ẩn popup login
					}else{				//Nếu server trả về false
						message = "Your username or password is incorrect";
						notytype = 'warning';
					}
					//Hiển thị thông báo
					var n = new Noty({
						text: message,
						theme: 'metroui',
						timeout: 2000,
						layout: 'center',
						type: notytype,
						closeWith: ['button'],
						buttons: [
							Noty.button('OK', 'btn btn-success', function () {
								n.close();	//Đóng thông báo khi nhấn OK
							})
						  ]
					}).show();
					//$("#username").val("");
					//$("#password").val("");
				});
		}); // .end phần 6 Login

	} ); // .end document ready
	
	//Xem hình ảnh ngay ở client khi chọn để upload (xem trước khi upload)
	function previewImage(input) {
		var preview = document.getElementById('preview');
		if (input.files && input.files[0]) {
		  var reader = new FileReader();
		  reader.onload = function (e) {
			preview.setAttribute('src', e.target.result);
		  }
		  reader.readAsDataURL(input.files[0]);
		} else {
		  preview.setAttribute('src', './image/person-placeholder.jpg');
		}
	}
  </script>
</body>
</html>